language: cpp
os:
  - osx
compiler:
  - clang
  
git:
  depth: 3
  lfs_skip_smudge: true

before_install:
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then
      brew update && brew install git-lfs libogg libvorbis flac;
      mkdir gtest;
      cd gtest;
      wget https://github.com/google/googletest/archive/release-1.8.0.tar.gz;
      tar -xzvf release-1.8.0.tar.gz;
      cd googletest-release-1.8.0;
      mkdir build;
      cd build;
      cmake -G"Unix Makefiles" ..;
      make;
      cp -r ../googletest/include/gtest /usr/local/include;
      cp googlemock/gtest/lib*.a /usr/local/lib;
      cd $TRAVIS_BUILD_DIR;
    fi

before_script:
  - git lfs pull
  - (mkdir build && cd build && cmake .. -DCMAKE_BUILD_TYPE=Release -DNIMEDIA_TESTS=ON)

script:
  - (cd build && cmake --build . && cmake --build . --target test)
