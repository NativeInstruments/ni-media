
shallow_clone: true

image:
  - Visual Studio 2017

platform:
  - x64

environment:
  matrix:
    - GENERATOR: Visual Studio 15 2017 Win64
      CONFIG: Release
      VCPKG_TARGET_TRIPLET: x64-windows-static

install:
  - git lfs install
  - vcpkg install boost:%VCPKG_TARGET_TRIPLET%
  - vcpkg install gtest:%VCPKG_TARGET_TRIPLET%
  - vcpkg install libOgg:%VCPKG_TARGET_TRIPLET%
  - vcpkg install libFlac:%VCPKG_TARGET_TRIPLET%
  - vcpkg install libVorbis:%VCPKG_TARGET_TRIPLET%

build_script:
  - mkdir build
  - cd build
  - cmake .. -G "%GENERATOR%" -DCMAKE_BUILD_TYPE=%CONFIG% -DNIMEDIA_ENABLE_MP3_DECODING=OFF -DNIMEDIA_ENABLE_MP4_DECODING=OFF -DNIMEDIA_STATIC_RUNTIME=ON -DCMAKE_TOOLCHAIN_FILE=C:\tools\vcpkg\scripts\buildsystems\vcpkg.cmake -DVCPKG_TARGET_TRIPLET=%VCPKG_TARGET_TRIPLET%
  - cmake --build . --config %CONFIG%

test_script:
  - cmake --build . --target RUN_TESTS --config %CONFIG%


