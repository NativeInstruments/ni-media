image:
  - Visual Studio 2017

platform:
  - x64

environment:
  GIT_LFS_SKIP_SMUDGE: 1
  
  matrix:
    - GENERATOR: Visual Studio 14 2015
      VCPKG_TARGET_TRIPLET: x86-windows-static
      CONFIG: Release
    
    - GENERATOR: Visual Studio 14 2015 Win64
      VCPKG_TARGET_TRIPLET: x64-windows-static
      CONFIG: Release
      
    - GENERATOR: Visual Studio 15 2017
      VCPKG_TARGET_TRIPLET: x86-windows-static
      CONFIG: Release
      
    - GENERATOR: Visual Studio 15 2017 Win64
      VCPKG_TARGET_TRIPLET: x64-windows-static
      CONFIG: Release

install:
  - vcpkg install boost:%VCPKG_TARGET_TRIPLET%
  - vcpkg install gtest:%VCPKG_TARGET_TRIPLET%
  - vcpkg install libOgg:%VCPKG_TARGET_TRIPLET%
  - vcpkg install libFlac:%VCPKG_TARGET_TRIPLET%
  - vcpkg install libVorbis:%VCPKG_TARGET_TRIPLET%

build_script:
  - mkdir build
  - cd build
  - cmake .. -G "%GENERATOR%" -DCMAKE_BUILD_TYPE=%CONFIG% -DNIMEDIA_STATIC_RUNTIME=ON -DCMAKE_TOOLCHAIN_FILE=C:\tools\vcpkg\scripts\buildsystems\vcpkg.cmake -DVCPKG_TARGET_TRIPLET=%VCPKG_TARGET_TRIPLET%
  - cmake --build . --config %CONFIG%

test_script:
  #- git lfs pull -X ""
  #- cmake --build . --target RUN_TESTS --config %CONFIG%

